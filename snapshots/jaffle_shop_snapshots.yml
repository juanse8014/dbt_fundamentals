version: 2

snapshots:
  - name: customers_history
    relation: ref('stg_jaffle_shop__customers')
    description: "SCD2 snapshot of customers"

    config:
      schema: PUBLIC
      strategy: check
      unique_key: customer_id

      check_cols:
        - first_name
        - last_name

      hard_deletes: invalidate